{"ast":null,"code":"var _jsxFileName = \"C:\\\\AurelienProj\\\\Stockify_React\\\\client\\\\src\\\\pages\\\\Sales\\\\Sales.jsx\",\n  _s = $RefreshSig$();\n// src/pages/Sales/Sales.jsx\nimport React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport \"./Sales.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Sales() {\n  _s();\n  const [sales, setSales] = useState([]);\n  const [saleItems, setSaleItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [selectedSale, setSelectedSale] = useState(null);\n  const [showForm, setShowForm] = useState(false);\n  const [formData, setFormData] = useState({\n    id: null,\n    payment_method: \"Credit Card\",\n    notes: \"\",\n    user_id: 1,\n    items: []\n  });\n  const [isEditing, setIsEditing] = useState(false);\n  const [products, setProducts] = useState([]);\n  const navigate = useNavigate();\n\n  // Charger les ventes depuis le serveur\n  useEffect(() => {\n    // Vérifier si l'utilisateur est connecté\n    const user = JSON.parse(localStorage.getItem(\"user\"));\n    if (!user) {\n      navigate(\"/\");\n      return;\n    }\n    fetchSales();\n    fetchProducts();\n  }, [navigate]);\n\n  // Fonction pour récupérer les ventes\n  const fetchSales = async () => {\n    setLoading(true);\n    try {\n      const salesResponse = await fetch(\"http://localhost:5000/api/sales\");\n      const itemsResponse = await fetch(\"http://localhost:5000/api/sale_items\");\n      if (!salesResponse.ok || !itemsResponse.ok) {\n        throw new Error(\"Erreur lors de la récupération des ventes\");\n      }\n      const salesData = await salesResponse.json();\n      const itemsData = await itemsResponse.json();\n      setSales(salesData);\n      setSaleItems(itemsData);\n    } catch (err) {\n      setError(err.message);\n      console.error(\"Erreur:\", err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Fonction pour récupérer les produits\n  const fetchProducts = async () => {\n    try {\n      const response = await fetch(\"http://localhost:5000/api/items\");\n      if (!response.ok) {\n        throw new Error(\"Erreur lors de la récupération des produits\");\n      }\n      const data = await response.json();\n      setProducts(data);\n    } catch (err) {\n      console.error(\"Erreur lors du chargement des produits:\", err);\n    }\n  };\n\n  // Sélectionner une vente pour afficher ses détails\n  const handleSelectSale = sale => {\n    setSelectedSale(sale.id === selectedSale ? null : sale.id);\n  };\n\n  // Gérer la soumission du formulaire\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    // Validation des champs\n    if (!formData.payment_method || formData.items.length === 0) {\n      alert(\"Veuillez sélectionner une méthode de paiement et ajouter au moins un article\");\n      return;\n    }\n    try {\n      // Calculer le montant total de la vente\n      const total_amount = formData.items.reduce((sum, item) => {\n        return sum + parseFloat(item.unit_price) * parseInt(item.quantity);\n      }, 0);\n      const saleData = {\n        payment_method: formData.payment_method,\n        notes: formData.notes,\n        user_id: formData.user_id,\n        total_amount\n      };\n      if (isEditing) {\n        // Mise à jour d'une vente existante\n        const response = await fetch(`http://localhost:5000/api/sales/${formData.id}`, {\n          method: \"PUT\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(saleData)\n        });\n        if (!response.ok) {\n          throw new Error(\"Erreur lors de la mise à jour de la vente\");\n        }\n        const updatedSale = await response.json();\n\n        // Mettre à jour les articles de la vente\n        await Promise.all(formData.items.map(async item => {\n          if (item.id) {\n            // Mettre à jour l'article existant\n            await fetch(`http://localhost:5000/api/sale_items/${item.id}`, {\n              method: \"PUT\",\n              headers: {\n                \"Content-Type\": \"application/json\"\n              },\n              body: JSON.stringify({\n                sale_id: updatedSale.id,\n                item_id: item.item_id,\n                quantity: item.quantity,\n                unit_price: item.unit_price\n              })\n            });\n          } else {\n            // Ajouter un nouvel article\n            await fetch(\"http://localhost:5000/api/sale_items\", {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\"\n              },\n              body: JSON.stringify({\n                sale_id: updatedSale.id,\n                item_id: item.item_id,\n                quantity: item.quantity,\n                unit_price: item.unit_price,\n                product_name: item.product_name\n              })\n            });\n          }\n        }));\n\n        // Supprimer les articles qui ont été retirés\n        const currentItems = saleItems.filter(item => item.sale_id === formData.id);\n        const updatedItemIds = formData.items.filter(item => item.id).map(item => item.id);\n        await Promise.all(currentItems.map(async item => {\n          if (!updatedItemIds.includes(item.id)) {\n            await fetch(`http://localhost:5000/api/sale_items/${item.id}`, {\n              method: \"DELETE\"\n            });\n          }\n        }));\n\n        // Mettre à jour l'état local\n        setSales(sales.map(sale => sale.id === updatedSale.id ? {\n          ...sale,\n          ...updatedSale\n        } : sale));\n        fetchSales(); // Recharger toutes les données pour mettre à jour les articles\n      } else {\n        // Ajout d'une nouvelle vente\n        const response = await fetch(\"http://localhost:5000/api/sales\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(saleData)\n        });\n        if (!response.ok) {\n          throw new Error(\"Erreur lors de l'ajout de la vente\");\n        }\n        const newSale = await response.json();\n\n        // Ajouter les articles de la vente\n        await Promise.all(formData.items.map(async item => {\n          await fetch(\"http://localhost:5000/api/sale_items\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              sale_id: newSale.id,\n              item_id: item.item_id,\n              quantity: item.quantity,\n              unit_price: item.unit_price,\n              product_name: item.product_name\n            })\n          });\n        }));\n\n        // Mettre à jour l'état local\n        setSales([...sales, newSale]);\n        fetchSales(); // Recharger toutes les données\n      }\n\n      // Réinitialiser le formulaire\n      resetForm();\n    } catch (err) {\n      console.error(\"Erreur lors de l'enregistrement de la vente:\", err);\n      alert(\"Une erreur est survenue lors de l'enregistrement de la vente\");\n    }\n  };\n\n  // Gérer les changements dans le formulaire\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFormData({\n      ...formData,\n      [name]: value\n    });\n  };\n\n  // Ajouter un article à la vente\n  const handleAddItem = () => {\n    if (products.length === 0) {\n      alert(\"Aucun produit disponible\");\n      return;\n    }\n    const newItem = {\n      item_id: products[0].id,\n      product_name: products[0].product_name,\n      quantity: 1,\n      unit_price: products[0].price,\n      subtotal: products[0].price\n    };\n    setFormData({\n      ...formData,\n      items: [...formData.items, newItem]\n    });\n  };\n\n  // Mettre à jour un article de la vente\n  const handleItemChange = (index, field, value) => {\n    const updatedItems = [...formData.items];\n    if (field === \"item_id\") {\n      const selectedProduct = products.find(p => p.id === parseInt(value));\n      updatedItems[index] = {\n        ...updatedItems[index],\n        item_id: parseInt(value),\n        product_name: selectedProduct.product_name,\n        unit_price: selectedProduct.price\n      };\n    } else {\n      updatedItems[index][field] = value;\n    }\n\n    // Recalculer le sous-total\n    updatedItems[index].subtotal = updatedItems[index].quantity * updatedItems[index].unit_price;\n    setFormData({\n      ...formData,\n      items: updatedItems\n    });\n  };\n\n  // Supprimer un article de la vente\n  const handleRemoveItem = index => {\n    const updatedItems = [...formData.items];\n    updatedItems.splice(index, 1);\n    setFormData({\n      ...formData,\n      items: updatedItems\n    });\n  };\n\n  // Réinitialiser le formulaire\n  const resetForm = () => {\n    setFormData({\n      id: null,\n      payment_method: \"Credit Card\",\n      notes: \"\",\n      user_id: 1,\n      items: []\n    });\n    setIsEditing(false);\n    setShowForm(false);\n  };\n\n  // Éditer une vente\n  const handleEdit = sale => {\n    const saleItemsList = saleItems.filter(item => item.sale_id === sale.id).map(item => ({\n      id: item.id,\n      item_id: item.item_id,\n      product_name: item.product_name,\n      quantity: item.quantity,\n      unit_price: item.unit_price,\n      subtotal: item.quantity * item.unit_price\n    }));\n    setFormData({\n      id: sale.id,\n      payment_method: sale.payment_method,\n      notes: sale.notes || \"\",\n      user_id: sale.user_id,\n      items: saleItemsList\n    });\n    setIsEditing(true);\n    setShowForm(true);\n  };\n\n  // Supprimer une vente\n  const handleDelete = async id => {\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer cette vente ?\")) {\n      try {\n        // Supprimer d'abord les articles liés à la vente\n        const itemsToDelete = saleItems.filter(item => item.sale_id === id);\n        await Promise.all(itemsToDelete.map(async item => {\n          await fetch(`http://localhost:5000/api/sale_items/${item.id}`, {\n            method: \"DELETE\"\n          });\n        }));\n\n        // Puis supprimer la vente\n        const response = await fetch(`http://localhost:5000/api/sales/${id}`, {\n          method: \"DELETE\"\n        });\n        if (!response.ok) {\n          throw new Error(\"Erreur lors de la suppression de la vente\");\n        }\n        setSales(sales.filter(sale => sale.id !== id));\n        setSaleItems(saleItems.filter(item => item.sale_id !== id));\n      } catch (err) {\n        console.error(\"Erreur lors de la suppression:\", err);\n        alert(\"Une erreur est survenue lors de la suppression de la vente\");\n      }\n    }\n  };\n\n  // Formater la date pour l'affichage\n  const formatDate = dateString => {\n    const options = {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    };\n    return new Date(dateString).toLocaleDateString(\"fr-FR\", options);\n  };\n\n  // Formater le montant pour l'affichage en dollars\n  const formatAmount = amount => {\n    // S'assurer que amount est un nombre\n    const numAmount = parseFloat(amount);\n\n    // Vérifier si c'est un nombre valide\n    if (isNaN(numAmount)) {\n      return '$0.00';\n    }\n    return numAmount.toLocaleString('en-US', {\n      style: 'currency',\n      currency: 'USD'\n    });\n  };\n\n  // Calculer le total des ventes\n  const calculateTotalSales = () => {\n    return sales.reduce((sum, sale) => sum + parseFloat(sale.total_amount || 0), 0);\n  };\n\n  // Obtenir les articles d'une vente spécifique\n  const getSaleItems = saleId => {\n    return saleItems.filter(item => item.sale_id === saleId);\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"Chargement des ventes...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 386,\n    columnNumber: 23\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"error-message\",\n    children: [\"Erreur: \", error]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 387,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"sales-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sales-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Gestion des ventes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"add-button\",\n        onClick: () => setShowForm(!showForm),\n        children: showForm ? \"Annuler\" : \"Nouvelle vente\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this), showForm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sales-form-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: isEditing ? \"Modifier la vente\" : \"Nouvelle vente\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"sales-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"payment_method\",\n              children: \"M\\xE9thode de paiement\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"payment_method\",\n              name: \"payment_method\",\n              value: formData.payment_method,\n              onChange: handleChange,\n              required: true,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Credit Card\",\n                children: \"Carte de cr\\xE9dit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 412,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Debit Card\",\n                children: \"Carte de d\\xE9bit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 413,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Cash\",\n                children: \"Esp\\xE8ces\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 414,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Bank Transfer\",\n                children: \"Virement bancaire\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"notes\",\n              children: \"Notes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 420,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              id: \"notes\",\n              name: \"notes\",\n              value: formData.notes,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 419,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sale-items-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sale-items-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Articles\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"add-item-button\",\n              onClick: handleAddItem,\n              children: \"Ajouter un article\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 434,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 15\n          }, this), formData.items.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-items\",\n            children: \"Aucun article ajout\\xE9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"sale-items-table\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Produit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 449,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Quantit\\xE9\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 450,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Prix unitaire\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 451,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Sous-total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 452,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Actions\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 453,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 448,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: formData.items.map((item, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"select\", {\n                    value: item.item_id,\n                    onChange: e => handleItemChange(index, \"item_id\", e.target.value),\n                    required: true,\n                    children: products.map(product => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: product.id,\n                      children: product.product_name\n                    }, product.id, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 466,\n                      columnNumber: 31\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 460,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 459,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"number\",\n                    value: item.quantity,\n                    onChange: e => handleItemChange(index, \"quantity\", parseInt(e.target.value)),\n                    min: \"1\",\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 473,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 472,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: formatAmount(item.unit_price)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 481,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: formatAmount(item.quantity * item.unit_price)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 484,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    className: \"remove-item-button\",\n                    onClick: () => handleRemoveItem(index),\n                    children: \"Supprimer\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 488,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 487,\n                  columnNumber: 25\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 458,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 456,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"tfoot\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  colSpan: \"3\",\n                  className: \"total-label\",\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 501,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  colSpan: \"2\",\n                  className: \"total-amount\",\n                  children: formatAmount(formData.items.reduce((sum, item) => sum + item.quantity * item.unit_price, 0))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 502,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 500,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 499,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: resetForm,\n            className: \"cancel-button\",\n            children: \"Annuler\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"save-button\",\n            children: isEditing ? \"Mettre à jour\" : \"Enregistrer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sales-stats\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stat-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Total des ventes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: formatAmount(calculateTotalSales())\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stat-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Nombre de ventes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: sales.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stat-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Moyenne par vente\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: formatAmount(sales.length ? calculateTotalSales() / sales.length : 0)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 529,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sales-table-container\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"sales-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"M\\xE9thode de paiement\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 555,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Montant\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 556,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Notes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 557,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Actions\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 558,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 553,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: sales.length === 0 ? /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: \"5\",\n              className: \"no-data\",\n              children: \"Aucune vente enregistr\\xE9e\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 564,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 563,\n            columnNumber: 15\n          }, this) : sales.map(sale => /*#__PURE__*/_jsxDEV(React.Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n              className: selectedSale === sale.id ? \"selected-row\" : \"\",\n              onClick: () => handleSelectSale(sale),\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: formatDate(sale.sale_date)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 575,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: sale.payment_method\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 576,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"amount-cell\",\n                children: formatAmount(sale.total_amount)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 577,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"notes-cell\",\n                children: sale.notes\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 580,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"actions-cell\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: e => {\n                    e.stopPropagation();\n                    handleEdit(sale);\n                  },\n                  className: \"edit-button\",\n                  children: \"Modifier\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 582,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: e => {\n                    e.stopPropagation();\n                    handleDelete(sale.id);\n                  },\n                  className: \"delete-button\",\n                  children: \"Supprimer\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 591,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 581,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 571,\n              columnNumber: 19\n            }, this), selectedSale === sale.id && /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: \"sale-details-row\",\n              children: /*#__PURE__*/_jsxDEV(\"td\", {\n                colSpan: \"5\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"sale-details\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                    children: \"D\\xE9tails de la vente\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 606,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n                    className: \"sale-items-detail-table\",\n                    children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                      children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                          children: \"Produit\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 610,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                          children: \"Quantit\\xE9\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 611,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                          children: \"Prix unitaire\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 612,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                          children: \"Sous-total\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 613,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 609,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 608,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                      children: getSaleItems(sale.id).length === 0 ? /*#__PURE__*/_jsxDEV(\"tr\", {\n                        children: /*#__PURE__*/_jsxDEV(\"td\", {\n                          colSpan: \"4\",\n                          className: \"no-data\",\n                          children: \"Aucun article\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 619,\n                          columnNumber: 35\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 618,\n                        columnNumber: 33\n                      }, this) : getSaleItems(sale.id).map(item => /*#__PURE__*/_jsxDEV(\"tr\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                          children: item.product_name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 626,\n                          columnNumber: 37\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: item.quantity\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 627,\n                          columnNumber: 37\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: formatAmount(item.unit_price)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 628,\n                          columnNumber: 37\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: formatAmount(item.quantity * item.unit_price)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 629,\n                          columnNumber: 37\n                        }, this)]\n                      }, item.id, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 625,\n                        columnNumber: 35\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 616,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 607,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 605,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 604,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 603,\n              columnNumber: 21\n            }, this)]\n          }, sale.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 570,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 561,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 551,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 390,\n    columnNumber: 5\n  }, this);\n}\n_s(Sales, \"kGnY9Eqvmsts43kb+cdWA8Qncd4=\", false, function () {\n  return [useNavigate];\n});\n_c = Sales;\nexport default Sales;\nvar _c;\n$RefreshReg$(_c, \"Sales\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","jsxDEV","_jsxDEV","Sales","_s","sales","setSales","saleItems","setSaleItems","loading","setLoading","error","setError","selectedSale","setSelectedSale","showForm","setShowForm","formData","setFormData","id","payment_method","notes","user_id","items","isEditing","setIsEditing","products","setProducts","navigate","user","JSON","parse","localStorage","getItem","fetchSales","fetchProducts","salesResponse","fetch","itemsResponse","ok","Error","salesData","json","itemsData","err","message","console","response","data","handleSelectSale","sale","handleSubmit","e","preventDefault","length","alert","total_amount","reduce","sum","item","parseFloat","unit_price","parseInt","quantity","saleData","method","headers","body","stringify","updatedSale","Promise","all","map","sale_id","item_id","product_name","currentItems","filter","updatedItemIds","includes","newSale","resetForm","handleChange","name","value","target","handleAddItem","newItem","price","subtotal","handleItemChange","index","field","updatedItems","selectedProduct","find","p","handleRemoveItem","splice","handleEdit","saleItemsList","handleDelete","window","confirm","itemsToDelete","formatDate","dateString","options","year","month","day","hour","minute","Date","toLocaleDateString","formatAmount","amount","numAmount","isNaN","toLocaleString","style","currency","calculateTotalSales","getSaleItems","saleId","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onSubmit","htmlFor","onChange","required","type","product","min","colSpan","Fragment","sale_date","stopPropagation","_c","$RefreshReg$"],"sources":["C:/AurelienProj/Stockify_React/client/src/pages/Sales/Sales.jsx"],"sourcesContent":["// src/pages/Sales/Sales.jsx\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"./Sales.css\";\r\n\r\nfunction Sales() {\r\n  const [sales, setSales] = useState([]);\r\n  const [saleItems, setSaleItems] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [selectedSale, setSelectedSale] = useState(null);\r\n  const [showForm, setShowForm] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    id: null,\r\n    payment_method: \"Credit Card\",\r\n    notes: \"\",\r\n    user_id: 1,\r\n    items: []\r\n  });\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [products, setProducts] = useState([]);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  // Charger les ventes depuis le serveur\r\n  useEffect(() => {\r\n    // Vérifier si l'utilisateur est connecté\r\n    const user = JSON.parse(localStorage.getItem(\"user\"));\r\n\r\n    if (!user) {\r\n      navigate(\"/\");\r\n      return;\r\n    }\r\n\r\n    fetchSales();\r\n    fetchProducts();\r\n  }, [navigate]);\r\n\r\n  // Fonction pour récupérer les ventes\r\n  const fetchSales = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const salesResponse = await fetch(\"http://localhost:5000/api/sales\");\r\n      const itemsResponse = await fetch(\"http://localhost:5000/api/sale_items\");\r\n\r\n      if (!salesResponse.ok || !itemsResponse.ok) {\r\n        throw new Error(\"Erreur lors de la récupération des ventes\");\r\n      }\r\n\r\n      const salesData = await salesResponse.json();\r\n      const itemsData = await itemsResponse.json();\r\n      \r\n      setSales(salesData);\r\n      setSaleItems(itemsData);\r\n    } catch (err) {\r\n      setError(err.message);\r\n      console.error(\"Erreur:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Fonction pour récupérer les produits\r\n  const fetchProducts = async () => {\r\n    try {\r\n      const response = await fetch(\"http://localhost:5000/api/items\");\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(\"Erreur lors de la récupération des produits\");\r\n      }\r\n      \r\n      const data = await response.json();\r\n      setProducts(data);\r\n    } catch (err) {\r\n      console.error(\"Erreur lors du chargement des produits:\", err);\r\n    }\r\n  };\r\n\r\n  // Sélectionner une vente pour afficher ses détails\r\n  const handleSelectSale = (sale) => {\r\n    setSelectedSale(sale.id === selectedSale ? null : sale.id);\r\n  };\r\n\r\n  // Gérer la soumission du formulaire\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Validation des champs\r\n    if (!formData.payment_method || formData.items.length === 0) {\r\n      alert(\"Veuillez sélectionner une méthode de paiement et ajouter au moins un article\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Calculer le montant total de la vente\r\n      const total_amount = formData.items.reduce((sum, item) => {\r\n        return sum + (parseFloat(item.unit_price) * parseInt(item.quantity));\r\n      }, 0);\r\n\r\n      const saleData = {\r\n        payment_method: formData.payment_method,\r\n        notes: formData.notes,\r\n        user_id: formData.user_id,\r\n        total_amount\r\n      };\r\n\r\n      if (isEditing) {\r\n        // Mise à jour d'une vente existante\r\n        const response = await fetch(\r\n          `http://localhost:5000/api/sales/${formData.id}`,\r\n          {\r\n            method: \"PUT\",\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify(saleData),\r\n          }\r\n        );\r\n\r\n        if (!response.ok) {\r\n          throw new Error(\"Erreur lors de la mise à jour de la vente\");\r\n        }\r\n\r\n        const updatedSale = await response.json();\r\n        \r\n        // Mettre à jour les articles de la vente\r\n        await Promise.all(formData.items.map(async (item) => {\r\n          if (item.id) {\r\n            // Mettre à jour l'article existant\r\n            await fetch(`http://localhost:5000/api/sale_items/${item.id}`, {\r\n              method: \"PUT\",\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n              },\r\n              body: JSON.stringify({\r\n                sale_id: updatedSale.id,\r\n                item_id: item.item_id,\r\n                quantity: item.quantity,\r\n                unit_price: item.unit_price\r\n              }),\r\n            });\r\n          } else {\r\n            // Ajouter un nouvel article\r\n            await fetch(\"http://localhost:5000/api/sale_items\", {\r\n              method: \"POST\",\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n              },\r\n              body: JSON.stringify({\r\n                sale_id: updatedSale.id,\r\n                item_id: item.item_id,\r\n                quantity: item.quantity,\r\n                unit_price: item.unit_price,\r\n                product_name: item.product_name\r\n              }),\r\n            });\r\n          }\r\n        }));\r\n\r\n        // Supprimer les articles qui ont été retirés\r\n        const currentItems = saleItems.filter(item => item.sale_id === formData.id);\r\n        const updatedItemIds = formData.items.filter(item => item.id).map(item => item.id);\r\n        \r\n        await Promise.all(currentItems.map(async (item) => {\r\n          if (!updatedItemIds.includes(item.id)) {\r\n            await fetch(`http://localhost:5000/api/sale_items/${item.id}`, {\r\n              method: \"DELETE\",\r\n            });\r\n          }\r\n        }));\r\n\r\n        // Mettre à jour l'état local\r\n        setSales(sales.map(sale => sale.id === updatedSale.id ? { ...sale, ...updatedSale } : sale));\r\n        fetchSales(); // Recharger toutes les données pour mettre à jour les articles\r\n      } else {\r\n        // Ajout d'une nouvelle vente\r\n        const response = await fetch(\"http://localhost:5000/api/sales\", {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify(saleData),\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error(\"Erreur lors de l'ajout de la vente\");\r\n        }\r\n\r\n        const newSale = await response.json();\r\n        \r\n        // Ajouter les articles de la vente\r\n        await Promise.all(formData.items.map(async (item) => {\r\n          await fetch(\"http://localhost:5000/api/sale_items\", {\r\n            method: \"POST\",\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({\r\n              sale_id: newSale.id,\r\n              item_id: item.item_id,\r\n              quantity: item.quantity,\r\n              unit_price: item.unit_price,\r\n              product_name: item.product_name\r\n            }),\r\n          });\r\n        }));\r\n\r\n        // Mettre à jour l'état local\r\n        setSales([...sales, newSale]);\r\n        fetchSales(); // Recharger toutes les données\r\n      }\r\n\r\n      // Réinitialiser le formulaire\r\n      resetForm();\r\n    } catch (err) {\r\n      console.error(\"Erreur lors de l'enregistrement de la vente:\", err);\r\n      alert(\"Une erreur est survenue lors de l'enregistrement de la vente\");\r\n    }\r\n  };\r\n\r\n  // Gérer les changements dans le formulaire\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData({ ...formData, [name]: value });\r\n  };\r\n\r\n  // Ajouter un article à la vente\r\n  const handleAddItem = () => {\r\n    if (products.length === 0) {\r\n      alert(\"Aucun produit disponible\");\r\n      return;\r\n    }\r\n    \r\n    const newItem = {\r\n      item_id: products[0].id,\r\n      product_name: products[0].product_name,\r\n      quantity: 1,\r\n      unit_price: products[0].price,\r\n      subtotal: products[0].price\r\n    };\r\n    \r\n    setFormData({\r\n      ...formData,\r\n      items: [...formData.items, newItem]\r\n    });\r\n  };\r\n\r\n  // Mettre à jour un article de la vente\r\n  const handleItemChange = (index, field, value) => {\r\n    const updatedItems = [...formData.items];\r\n    \r\n    if (field === \"item_id\") {\r\n      const selectedProduct = products.find(p => p.id === parseInt(value));\r\n      updatedItems[index] = {\r\n        ...updatedItems[index],\r\n        item_id: parseInt(value),\r\n        product_name: selectedProduct.product_name,\r\n        unit_price: selectedProduct.price\r\n      };\r\n    } else {\r\n      updatedItems[index][field] = value;\r\n    }\r\n    \r\n    // Recalculer le sous-total\r\n    updatedItems[index].subtotal = updatedItems[index].quantity * updatedItems[index].unit_price;\r\n    \r\n    setFormData({\r\n      ...formData,\r\n      items: updatedItems\r\n    });\r\n  };\r\n\r\n  // Supprimer un article de la vente\r\n  const handleRemoveItem = (index) => {\r\n    const updatedItems = [...formData.items];\r\n    updatedItems.splice(index, 1);\r\n    \r\n    setFormData({\r\n      ...formData,\r\n      items: updatedItems\r\n    });\r\n  };\r\n\r\n  // Réinitialiser le formulaire\r\n  const resetForm = () => {\r\n    setFormData({\r\n      id: null,\r\n      payment_method: \"Credit Card\",\r\n      notes: \"\",\r\n      user_id: 1,\r\n      items: []\r\n    });\r\n    setIsEditing(false);\r\n    setShowForm(false);\r\n  };\r\n\r\n  // Éditer une vente\r\n  const handleEdit = (sale) => {\r\n    const saleItemsList = saleItems.filter(item => item.sale_id === sale.id).map(item => ({\r\n      id: item.id,\r\n      item_id: item.item_id,\r\n      product_name: item.product_name,\r\n      quantity: item.quantity,\r\n      unit_price: item.unit_price,\r\n      subtotal: item.quantity * item.unit_price\r\n    }));\r\n    \r\n    setFormData({\r\n      id: sale.id,\r\n      payment_method: sale.payment_method,\r\n      notes: sale.notes || \"\",\r\n      user_id: sale.user_id,\r\n      items: saleItemsList\r\n    });\r\n    \r\n    setIsEditing(true);\r\n    setShowForm(true);\r\n  };\r\n\r\n  // Supprimer une vente\r\n  const handleDelete = async (id) => {\r\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer cette vente ?\")) {\r\n      try {\r\n        // Supprimer d'abord les articles liés à la vente\r\n        const itemsToDelete = saleItems.filter(item => item.sale_id === id);\r\n        \r\n        await Promise.all(itemsToDelete.map(async (item) => {\r\n          await fetch(`http://localhost:5000/api/sale_items/${item.id}`, {\r\n            method: \"DELETE\",\r\n          });\r\n        }));\r\n        \r\n        // Puis supprimer la vente\r\n        const response = await fetch(\r\n          `http://localhost:5000/api/sales/${id}`,\r\n          {\r\n            method: \"DELETE\",\r\n          }\r\n        );\r\n\r\n        if (!response.ok) {\r\n          throw new Error(\"Erreur lors de la suppression de la vente\");\r\n        }\r\n\r\n        setSales(sales.filter((sale) => sale.id !== id));\r\n        setSaleItems(saleItems.filter((item) => item.sale_id !== id));\r\n      } catch (err) {\r\n        console.error(\"Erreur lors de la suppression:\", err);\r\n        alert(\"Une erreur est survenue lors de la suppression de la vente\");\r\n      }\r\n    }\r\n  };\r\n\r\n  // Formater la date pour l'affichage\r\n  const formatDate = (dateString) => {\r\n    const options = { year: \"numeric\", month: \"long\", day: \"numeric\", hour: \"2-digit\", minute: \"2-digit\" };\r\n    return new Date(dateString).toLocaleDateString(\"fr-FR\", options);\r\n  };\r\n\r\n  // Formater le montant pour l'affichage en dollars\r\n  const formatAmount = (amount) => {\r\n    // S'assurer que amount est un nombre\r\n    const numAmount = parseFloat(amount);\r\n    \r\n    // Vérifier si c'est un nombre valide\r\n    if (isNaN(numAmount)) {\r\n      return '$0.00';\r\n    }\r\n    \r\n    return numAmount.toLocaleString('en-US', {\r\n      style: 'currency',\r\n      currency: 'USD',\r\n    });\r\n  };\r\n\r\n  // Calculer le total des ventes\r\n  const calculateTotalSales = () => {\r\n    return sales.reduce((sum, sale) => sum + parseFloat(sale.total_amount || 0), 0);\r\n  };\r\n\r\n  // Obtenir les articles d'une vente spécifique\r\n  const getSaleItems = (saleId) => {\r\n    return saleItems.filter(item => item.sale_id === saleId);\r\n  };\r\n\r\n  if (loading) return <div className=\"loading\">Chargement des ventes...</div>;\r\n  if (error) return <div className=\"error-message\">Erreur: {error}</div>;\r\n\r\n  return (\r\n    <div className=\"sales-page\">\r\n      <div className=\"sales-header\">\r\n        <h1>Gestion des ventes</h1>\r\n        <button className=\"add-button\" onClick={() => setShowForm(!showForm)}>\r\n          {showForm ? \"Annuler\" : \"Nouvelle vente\"}\r\n        </button>\r\n      </div>\r\n\r\n      {showForm && (\r\n        <div className=\"sales-form-container\">\r\n          <h2>{isEditing ? \"Modifier la vente\" : \"Nouvelle vente\"}</h2>\r\n          <form onSubmit={handleSubmit} className=\"sales-form\">\r\n            <div className=\"form-row\">\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"payment_method\">Méthode de paiement</label>\r\n                <select\r\n                  id=\"payment_method\"\r\n                  name=\"payment_method\"\r\n                  value={formData.payment_method}\r\n                  onChange={handleChange}\r\n                  required\r\n                >\r\n                  <option value=\"Credit Card\">Carte de crédit</option>\r\n                  <option value=\"Debit Card\">Carte de débit</option>\r\n                  <option value=\"Cash\">Espèces</option>\r\n                  <option value=\"Bank Transfer\">Virement bancaire</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"notes\">Notes</label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"notes\"\r\n                  name=\"notes\"\r\n                  value={formData.notes}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"sale-items-section\">\r\n              <div className=\"sale-items-header\">\r\n                <h3>Articles</h3>\r\n                <button \r\n                  type=\"button\" \r\n                  className=\"add-item-button\"\r\n                  onClick={handleAddItem}\r\n                >\r\n                  Ajouter un article\r\n                </button>\r\n              </div>\r\n\r\n              {formData.items.length === 0 ? (\r\n                <div className=\"no-items\">Aucun article ajouté</div>\r\n              ) : (\r\n                <table className=\"sale-items-table\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th>Produit</th>\r\n                      <th>Quantité</th>\r\n                      <th>Prix unitaire</th>\r\n                      <th>Sous-total</th>\r\n                      <th>Actions</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {formData.items.map((item, index) => (\r\n                      <tr key={index}>\r\n                        <td>\r\n                          <select\r\n                            value={item.item_id}\r\n                            onChange={(e) => handleItemChange(index, \"item_id\", e.target.value)}\r\n                            required\r\n                          >\r\n                            {products.map(product => (\r\n                              <option key={product.id} value={product.id}>\r\n                                {product.product_name}\r\n                              </option>\r\n                            ))}\r\n                          </select>\r\n                        </td>\r\n                        <td>\r\n                          <input\r\n                            type=\"number\"\r\n                            value={item.quantity}\r\n                            onChange={(e) => handleItemChange(index, \"quantity\", parseInt(e.target.value))}\r\n                            min=\"1\"\r\n                            required\r\n                          />\r\n                        </td>\r\n                        <td>\r\n                          {formatAmount(item.unit_price)}\r\n                        </td>\r\n                        <td>\r\n                          {formatAmount(item.quantity * item.unit_price)}\r\n                        </td>\r\n                        <td>\r\n                          <button\r\n                            type=\"button\"\r\n                            className=\"remove-item-button\"\r\n                            onClick={() => handleRemoveItem(index)}\r\n                          >\r\n                            Supprimer\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                  <tfoot>\r\n                    <tr>\r\n                      <td colSpan=\"3\" className=\"total-label\">Total</td>\r\n                      <td colSpan=\"2\" className=\"total-amount\">\r\n                        {formatAmount(\r\n                          formData.items.reduce((sum, item) => sum + (item.quantity * item.unit_price), 0)\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                  </tfoot>\r\n                </table>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"form-buttons\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={resetForm}\r\n                className=\"cancel-button\"\r\n              >\r\n                Annuler\r\n              </button>\r\n              <button type=\"submit\" className=\"save-button\">\r\n                {isEditing ? \"Mettre à jour\" : \"Enregistrer\"}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"sales-stats\">\r\n        <div className=\"stat-card\">\r\n          <h3>Total des ventes</h3>\r\n          <p>{formatAmount(calculateTotalSales())}</p>\r\n        </div>\r\n        <div className=\"stat-card\">\r\n          <h3>Nombre de ventes</h3>\r\n          <p>{sales.length}</p>\r\n        </div>\r\n        <div className=\"stat-card\">\r\n          <h3>Moyenne par vente</h3>\r\n          <p>\r\n            {formatAmount(\r\n              sales.length\r\n                ? calculateTotalSales() / sales.length\r\n                : 0\r\n            )}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"sales-table-container\">\r\n        <table className=\"sales-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Date</th>\r\n              <th>Méthode de paiement</th>\r\n              <th>Montant</th>\r\n              <th>Notes</th>\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {sales.length === 0 ? (\r\n              <tr>\r\n                <td colSpan=\"5\" className=\"no-data\">\r\n                  Aucune vente enregistrée\r\n                </td>\r\n              </tr>\r\n            ) : (\r\n              sales.map((sale) => (\r\n                <React.Fragment key={sale.id}>\r\n                  <tr\r\n                    className={selectedSale === sale.id ? \"selected-row\" : \"\"}\r\n                    onClick={() => handleSelectSale(sale)}\r\n                  >\r\n                    <td>{formatDate(sale.sale_date)}</td>\r\n                    <td>{sale.payment_method}</td>\r\n                    <td className=\"amount-cell\">\r\n                      {formatAmount(sale.total_amount)}\r\n                    </td>\r\n                    <td className=\"notes-cell\">{sale.notes}</td>\r\n                    <td className=\"actions-cell\">\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleEdit(sale);\r\n                        }}\r\n                        className=\"edit-button\"\r\n                      >\r\n                        Modifier\r\n                      </button>\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleDelete(sale.id);\r\n                        }}\r\n                        className=\"delete-button\"\r\n                      >\r\n                        Supprimer\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                  {selectedSale === sale.id && (\r\n                    <tr className=\"sale-details-row\">\r\n                      <td colSpan=\"5\">\r\n                        <div className=\"sale-details\">\r\n                          <h4>Détails de la vente</h4>\r\n                          <table className=\"sale-items-detail-table\">\r\n                            <thead>\r\n                              <tr>\r\n                                <th>Produit</th>\r\n                                <th>Quantité</th>\r\n                                <th>Prix unitaire</th>\r\n                                <th>Sous-total</th>\r\n                              </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                              {getSaleItems(sale.id).length === 0 ? (\r\n                                <tr>\r\n                                  <td colSpan=\"4\" className=\"no-data\">\r\n                                    Aucun article\r\n                                  </td>\r\n                                </tr>\r\n                              ) : (\r\n                                getSaleItems(sale.id).map((item) => (\r\n                                  <tr key={item.id}>\r\n                                    <td>{item.product_name}</td>\r\n                                    <td>{item.quantity}</td>\r\n                                    <td>{formatAmount(item.unit_price)}</td>\r\n                                    <td>{formatAmount(item.quantity * item.unit_price)}</td>\r\n                                  </tr>\r\n                                ))\r\n                              )}\r\n                            </tbody>\r\n                          </table>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  )}\r\n                </React.Fragment>\r\n              ))\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Sales;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}